/**
* Multi Social Service Plugin
*
* This Plugin is connect your site to social service.
*
* [Support Social Service]
*  + Hatena Bookmark
*  + Twitter
*  + Facebook
*  + Evernote
*  + mixi check
*  + mixi like
*  + gree like
*  + Google +1
*
* @author   Ryosuke Sawada as manji6 <http://manjiro.net>
* @requires jQuery
* @license  MIT licence
*
**/
function encodeURIComponentRFC3986(a){return encodeURIComponent(a).replace(/[!*'()]/g,function(a){return"%"+a.charCodeAt(0).toString(16)})}
jQuery.multiSocialService={url:encodeURIComponentRFC3986(location.href),useService:"twitter,facebookLike,hatenaBookmark,evernoteClip,mixiLike,greeLike".split(","),enableTracking:!1,hatenaBookmark:{type:"horizontal"},twitter:{tweet:{type:"horizontal",lang:"",text:"",via:""},follow:{user:"","data-button":"","data-text-color":"","data-link-color":"",show_count:"true",lang:"ja"},tweetLite:{text:"",via:""}},facebook:{like:{type:"button_count",show_faces:"false",color:"light",width:100,height:23,lang:"",
send:"false",ogp:{title:document.title,image:"",description:"",app_id:"",type:"blog",site_name:""}},likeLite:{},comments:{num_posts:"3",width:"500",app_id:""}},evernote:{clip:{targetId:"container",name:"",tag:"",url:"",noteTitle:$("title").text()}},mixi:{check:{"data-key":"","data-url":"","data-button":"button-1"},like:{href:"",service_key:"",width:"450",height:"80",show_faces:"false"}},gree:{like:{href:"",service_key:"",type:0,height:20}},google:{plus1:{lang:"ja",callback:"",count:!0,size:""}}};
jQuery.fn.setMultiSocialService=function(){for(var a="<div class='multiSocialService-container'><ul class='multiSocialService-list' style='list-style-type:none'>",b=0,c=jQuery.multiSocialService.useService.length;b<c;b++)switch(jQuery.multiSocialService.useService[b]){case "hatenaBookmark":a+='<li class="multiSocialService-hatenaBookmark">'+jQuery("<li />").setHatenaBookmark(jQuery.multiSocialService.hatenaBookmark).html()+"</li>";break;case "twitter":a+='<li class="multiSocialService-twitter">'+
jQuery("<li />").setTwitter(jQuery.multiSocialService.twitter.tweet).html()+"</li>";break;case "facebookLike":a+='<li class="multiSocialService-facebookLike">'+jQuery("<li />").setFacebookLike(jQuery.multiSocialService.facebook.like).html()+"</li>";break;case "evernoteClip":a+='<li class="multiSocialService-evernoteClip">'+jQuery("<li />").setEvernoteClip(jQuery.multiSocialService.evernote.clip).html()+"</li>";break;case "mixiCheck":a+='<li class="multiSocialService-mixiCheck">'+jQuery("<li />").setMixiCheck(jQuery.multiSocialService.mixi.check).html()+
"</li>";break;case "mixiLike":a+='<li class="multiSocialService-mixiLike">'+jQuery("<li />").setMixiLike(jQuery.multiSocialService.mixi.like).html()+"</li>";break;case "greeLike":a+='<li class="multiSocialService-greeLike">'+jQuery("<li />").setGreeLike(jQuery.multiSocialService.gree.like).html()+"</li>";break;case "googlePlus1":a+='<li class="multiSocialService-googlePlus1">'+jQuery("<li />").setGooglePlus1(jQuery.multiSocialService.google.plus1).html()+"</li>"}a+="</ul></div>";$(this).html($(a).find("li").css("display",
"inline").end().html());return this};jQuery.multiSocialService.initialize=function(a){"string"===typeof a?a=encodeURIComponentRFC3986(decodeURIComponent(a)):a.url=encodeURIComponentRFC3986(decodeURIComponent(a.url));return a};
jQuery.fn.setHatenaBookmark=function(a){a=jQuery.multiSocialService.initialize(jQuery.extend(!0,{},jQuery.multiSocialService.hatenaBookmark,a));a='<a href="http://b.hatena.ne.jp/entry/'+jQuery.multiSocialService.url+'" class="hatena-bookmark-button" data-hatena-bookmark-layout="'+a.type+'" title="\u3053\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u3092\u306f\u3066\u306a\u30d6\u30c3\u30af\u30de\u30fc\u30af\u306b\u8ffd\u52a0"><img src="http://b.st-hatena.com/images/entry-button/button-only.gif" alt="\u3053\u306e\u30a8\u30f3\u30c8\u30ea\u30fc\u3092\u306f\u3066\u306a\u30d6\u30c3\u30af\u30de\u30fc\u30af\u306b\u8ffd\u52a0" width="20" height="20" style="border: none;" /></a><script type="text/javascript" src="http://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"><\/script>';
$(this).html(a);return this};
jQuery.fn.setTwitter=function(a){a=jQuery.extend(!0,{},jQuery.multiSocialService.twitter.tweet,a);a.url="string"===$.type(a.url)&&0<a.url.length?encodeURIComponentRFC3986(a.url):jQuery.multiSocialService.url;var b='<a href="http://twitter.com/share" data-url="'+a.url+'" class="twitter-share-button" data-count="'+a.type+'" data-via="'+a.via+'" data-text="'+a.text+'" data-lang="'+a.lang+'">Tweet</a><script type="text/javascript"src="http://platform.twitter.com/widgets.js" charset="utf-8"><\/script>';$(this).html(b);
jQuery.multiSocialService.tracking("twitter",a.url);return this};
jQuery.fn.setTwitterFollow=function(a){a=jQuery.multiSocialService.initialize(jQuery.extend(!0,{},jQuery.multiSocialService.twitter.follow,a));a='<a href="https://twitter.com/'+a.user+'" class="twitter-follow-button" data-show-count="'+a.show_count+'" data-button="'+a["data-button"]+'"data-text-color="'+a["data-text-color"]+'" data-link-color="'+a["data-link-color"]+'" data-lang="'+a.lang+'">follow</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js" charset="utf-8"><\/script>';$(this).html(a);
return this};
jQuery.fn.setTwitterTweetLite=function(a){a=jQuery.extend(!0,{},jQuery.multiSocialService.twitter.tweetLite,a);a.url="string"===$.type(a.url)&&0<a.url.length?encodeURIComponentRFC3986(a.url):jQuery.multiSocialService.url;$(this).click(function(){window.open("https://twitter.com/intent/tweet?"+(""!==a.text?"text="+encodeURIComponentRFC3986(a.text):"")+"&url="+a.url+(""!==a.via?"&via="+a.via:""),"","toolbar=0, status=0, width=650, height=360");!0===jQuery.multiSocialService.enableTracking&&_gaq.push(["_trackSocial",
"twitter","tweet"])})};jQuery.getTwitterTweetCount=function(a){var b="string"===jQuery.type(a.url)?a.url:decodeURIComponent(jQuery.multiSocialService.url);jQuery.ajax({url:"http://cdn.api.twitter.com/1/urls/count.json",data:{url:b},dataType:"jsonp",cache:!1,success:function(b){a.callback.call(this,b)}})};
jQuery.fn.setFacebookLike=function(a){a=jQuery.extend(!0,{},jQuery.multiSocialService.facebook.like,a);"en"===a.lang&&(a.lang="locale=en_US&");void 0!==$("meta").filter(function(){return"fb:app_id"===$(this).attr("property")}).attr("content")&&(a.ogp.app_id=$("meta").filter(function(){return"fb:app_id"===$(this).attr("property")}).attr("content"));if(a.ogp.app_id){$("head").append("<meta property='fb:app_id' content='"+a.ogp.app_id+"' />");var b;b='<div id="fb-root"></div><script>(function(d, s, id) {  var js, fjs = d.getElementsByTagName(s)[0];  if (d.getElementById(id)) {return;}  js = d.createElement(s); js.id = id;'+
('  js.src = "//connect.facebook.net/ja_JP/all.js#xfbml=1&appId='+a.ogp.app_id+'";');$("body").append(b+'  fjs.parentNode.insertBefore(js, fjs);}(document, "script", "facebook-jssdk"));<\/script>');$("html").attr("xmlns:fb","http://ogp.me/ns/fb#");b=""+('<fb:like href="'+encodeURIComponent(jQuery.multiSocialService.url)+'"');b+='send="'+a.send+'"';b+='layout="'+a.type+'"';b+='width="'+a.width+'"';b+='show_faces="'+a.show_faces+'"';$(this).html(b+"></fb:like>")}else b="<iframe src='http://www.facebook.com/plugins/like.php?"+
a.lang+"app_id="+a.ogp.app_id+"&href="+encodeURIComponent(jQuery.multiSocialService.url)+"&amp;layout="+a.type+"&amp;show_faces="+a.show_faces+"&amp;width=450&amp;action=like&amp;font&amp;colorscheme="+a.color+"&amp;height=21' scrolling='no' frameborder='0' style='border:none; overflow:hidden; width:"+a.width+"px; height:"+a.height+"px;' allowTransparency='true'></iframe>",$(this).html(b);jQuery.multiSocialService.tracking("facebook",a.url);return this};
jQuery.fn.setFacebookComments=function(a){a=jQuery.extend(!0,{},jQuery.multiSocialService.facebook.comments,a);void 0!==$("meta").filter(function(){return"fb:app_id"===$(this).attr("property")}).attr("content")&&(a.app_id=$("meta").filter(function(){return"fb:app_id"===$(this).attr("property")}).attr("content"));if(!a.app_id)return!1;var b;b='<div id="fb-root"></div><script>(function(d, s, id) {  var js, fjs = d.getElementsByTagName(s)[0];  if (d.getElementById(id)) {return;}  js = d.createElement(s); js.id = id;'+
('  js.src = "//connect.facebook.net/ja_JP/all.js#xfbml=1&appId='+a.app_id+'";');$("body").append(b+'  fjs.parentNode.insertBefore(js, fjs);}(document, "script", "facebook-jssdk"));<\/script>');$("html").attr("xmlns:fb","http://ogp.me/ns/fb#");b=""+('<fb:comments href="'+encodeURIComponent(jQuery.multiSocialService.url)+'"');b+='num_posts="'+a.num_posts+'"';b+='width="'+a.width+'"';$(this).html(b+"></fb:comments>");return this};
jQuery.fn.setFacebookLikeLite=function(a){a=jQuery.extend(!0,{},jQuery.multiSocialService.facebook.likeLite,a);a.url="string"===$.type(a.url)&&0<a.url.length?encodeURIComponentRFC3986(a.url):jQuery.multiSocialService.url;$(this).click(function(){window.open("http://www.facebook.com/sharer.php?u="+a.url+"","","toolbar=0, status=0, width=900, height=500");!0===jQuery.multiSocialService.enableTracking&&_gaq.push(["_trackSocial","facebook","like"])})};
jQuery.getFacebookCount=function(a){var b="string"===jQuery.type(a.url)?a.url:decodeURIComponent(jQuery.multiSocialService.url);jQuery.ajax({url:"http://graph.facebook.com/"+b,dataType:"jsonp",cache:!1,success:function(b){a.callback.call(this,b)}})};
jQuery.fn.setEvernoteClip=function(a){a=jQuery.extend(!0,{},jQuery.multiSocialService.evernote.clip,a);a='<script type="text/javascript" src="http://static.evernote.com/noteit.js" charset="utf-8"><\/script><a href="#" onclick="Evernote.doClip({contentId:\''+a.targetId+"',providerName:'"+a.name+"',url:'"+a.url+"',suggestTags:'"+a.tag+"',title:'"+a.noteTitle+'\'}); return false;"><img src="http://static.evernote.com/article-clipper-jp.png" alt="Clip to Evernote" /></a>';$(this).html(a);return this};
jQuery.fn.setMixiCheck=function(a){a=jQuery.extend(!0,{},jQuery.multiSocialService.mixi.check,a);if(""===a.data_key)return alert("plase set data_key."),!1;a='<a href="http://mixi.jp/share.pl" class="mixi-check-button" data-key="'+a["data-key"]+'" data-url="'+a["data-url"]+'" data-button="'+a["data-button"]+'">mixi\u30c1\u30a7\u30c3\u30af</a><script type="text/javascript" src="http://static.mixi.jp/js/share.js" charset="utf-8"><\/script>';$(this).html(a);return this};
jQuery.fn.setMixiLike=function(a){a=jQuery.extend(!0,jQuery.multiSocialService.mixi.like,a);a.href=jQuery.multiSocialService.url;if(""===a.service_key)return alert("plase set service_key."),!1;a='<iframe src="http://plugins.mixi.jp/favorite.pl?'+$.param(a)+'" scrolling="no" frameborder="0" allowTransparency="true" style="border:0; overflow:hidden; width:'+a.width+"px; height:"+a.height+'px;"></iframe>';$(this).html(a);return this};
jQuery.fn.setGreeLike=function(a){a=jQuery.extend(!0,{},jQuery.multiSocialService.gree.like,a);a.href=jQuery.multiSocialService.url;a='<iframe src="http://share.gree.jp/share?url='+a.href+"&type="+a.type+"&height="+a.height+'" scrolling="no" frameborder="0" marginwidth="0" marginheight="0" style="border:none; overflow:hidden; width:100px; height:'+a.height+'px;" allowTransparency="true"></iframe>';$(this).html(a);return this};
jQuery.fn.setGooglePlus1=function(a){a=jQuery.extend(!0,{},jQuery.multiSocialService.google.plus1,a);a.url="string"===$.type(a.url)&&0<a.url.length?encodeURIComponentRFC3986(a.url):jQuery.multiSocialService.url;var b;b=""+('<script type="text/javascript" src="https://apis.google.com/js/plusone.js" charset="utf-8">{lang: "'+a.lang+'"}<\/script>');b+='<g:plusone size="'+a.size+'" count="'+a.count+'" href="'+a.url+'" callback="'+a.callback+'"></g:plusone>';$(this).html(b);return this};
jQuery.setOGP=function(a){jQuery.extend(!0,{},{title:document.title},a);$("head").append(aHtmlOGP)};
jQuery.multiSocialService.tracking=function(a){if(!0!==jQuery.multiSocialService.enableTracking&&"undefined"===jQuery.type(_gaq))return!0;"facebook"===a?fb=window.setInterval(function(){"undefined"!==typeof FB&&(FB.Event.subscribe("edge.create",function(a){_gaq.push(["_trackSocial","facebook","like",a])}),FB.Event.subscribe("edge.remove",function(a){_gaq.push(["_trackSocial","facebook","unlike",a])}),FB.Event.subscribe("message.send",function(a){_gaq.push(["_trackSocial","facebook","send",a])}),clearInterval(fb))},
1E3):"twitter"===a&&(tw=window.setInterval(function(){"undefined"!==typeof twttr&&(twttr.events.bind("tweet",function(a){a&&_gaq.push(["_trackSocial","twitter","tweet"])}),clearInterval(tw))},1E3))};
